https://ntrs.nasa.gov/api/citations/20140004055/downloads/20140004055.pdf

## Formal Methods Case Studies for DO-333

## 摘要
RTCA DO-333, DO-178C和DO-278A的正式方法补充，为希望在机载系统和空中交通管理系统认证中使用正式方法的软件开发人员提供指导。补充说明了对DO-178C和DO-278A目标、活动和软件生命周期数据的修改和补充，当正式方法被用作软件开发过程的一部分时，这些数据应该被处理。
**本报告提出了三个案例研究，描述了使用不同类别的形式化方法来满足通用航空电子设备示例的认证目标-双通道飞行制导系统。
这三个案例研究说明了定理证明、模型检查和抽象解释的使用。**
所提供的材料并不代表完整的认证工作。相反，目的是说明如何在现实的航空电子软件开发项目中使用形式化方法，重点关注可用于满足DO-178C第6节中发现的验证目标的证据。

## 案例：双通道飞行制导系统（FGS）
FGS是整个飞行控制系统(FCS)的组成部分。它将飞机的测量状态(位置、速度和姿态)与期望状态进行比较，并生成俯仰和滚转制导命令，以最小化测量状态和期望状态之间的差异。强调FGS作用的FCS概述如图3所示。

![alt text](image.png)
如图3所示，FGS子系统接受来自姿态航向参考系统(AHRS)、空气数据系统(ADS)、飞行管理系统(FMS)和导航无线电的关于飞机状态的输入。利用这些信息，它计算出提供给自动驾驶仪(AP)的俯仰和侧倾制导命令。当启动时，AP将这些命令转换为飞机控制面的运动，以实现关于横向和垂直轴的命令变化。

机组人员主要通过飞行控制面板(FCP)与FGS进行交互，如图4所示。FCP包括打开和关闭飞行指挥(FD)的开关，选择不同飞行模式的开关，如垂直速度(VS)，横向导航(NAV)，航向选择(HDG)，高度保持(ALT)和进近(APPR)，垂直速度/俯仰轮和AP断开条。FCP还向机组人员提供反馈，通过在选择模式按钮的两侧点亮灯来指示选择的模式
![alt text](image-1.png)
一些关键的控制，如Go Around按钮、AP分离开关和SYNC开关都安装在控制轭和节流阀上，并通过FCP传送到FGS。通过DCP (Display Control Panel)选择导航源，选择的导航源通过PFD路由到FGS。

如图3所示，FGS有两个物理侧面或通道，一个在飞机的左侧，一个在飞机的右侧。它们提供了通过跨通道总线相互通信的冗余实现。FGS的每个通道可以进一步分解为模态逻辑和飞行控制律。飞行控制律接受飞行器当前和期望状态的信息，并计算俯仰和滚转制导命令。如果飞行控制律的引导命令被用来控制飞机或为机组人员提供视觉提示，那么它就是有效的。一个飞行控制法则是可操作的，但还没有被激活。模式逻辑决定了在任何给定时间哪种横向和垂直操作模式是有效的(例如控制飞机或向机组人员提供视觉引导线索)和武装的(例如操作但尚未激活)。这些反过来又决定了哪些飞行控制律是有效的和武装的。这些都是在主飞行显示器(PFD)上发出或显示的，同时还有由FGS生成的飞行制导命令的图形描述。

主飞行显示器(PFD)的简化图像如图5所示。PFD显示飞机的基本信息，如空速、垂直速度、姿态、地平线和航向。活动的横向和垂直模式显示(公告)在显示器的顶部。图5中的提示信息表明，当前有效的横向模式为滚持(Roll)，有效的垂直模式为俯仰保持(Pitch)，高度选择(ALTSEL)模式已启用。
![alt text](image-2.png)

PFD中心的大球体是姿态指示器。穿过它中间的水平线是人造地平线。飞机当前的俯仰和横摇由姿态指示器中间的一个白色楔形表示。图5描绘了一架飞机在水平飞行，零滚度和零俯仰度。

俯仰和滚转制导命令在PFD上的图形表示被称为飞行指导(FD)。俯仰和滚转引导指令显示为天空/滚地球中的灰色楔形。当AP不参与时，这些被解释为对飞行员的指导。当AP启动时，这些指示指示飞机由AP驾驶的方向。AP启动由模式提示下直接显示的字母AP表示。图5描述了一架飞机，其中AP被接合，FD命令飞行员将俯仰上升7.5度。

在大多数飞行模式下，FGS以依赖模式工作，只有一个FGS通道处于活动状态，为FD和AP提供引导。另一个FGS通道作为热备，设置自己的模式与活动端的模式相匹配。这是由直接显示在模式通告下面的飞行员飞行指示器指示的，该指示器指向飞行员飞行(主动)一侧。在一些更关键的模式中，如进近、起飞和复飞，FGS在独立模式下工作，两个通道都是活动的，并且独立地计算制导命令，这些命令必须同意AP参与。

### 案例研究1：定理证明
两种不同的交互式定理证明工具的使用:PVS和HOL4。
#### PVS和HOL4的简介
##### 原型验证系统(Prototype Verification System, PVS)
PVS通常是与支持工具和自动定理证明器集成的规范语言。它是自1993年以来在加州门洛帕克的SRI国际计算机科学实验室开发的。当我们创建或应用新功能时，它基本上是研究原型，随着它的发展和改进，以及随着实际使用的压力暴露出所有新需求。PVS规范语言通常基于经典的、类型化的高阶逻辑。这种规范语言是指定理论库所必需的。原型验证系统(PVS)还包括用于验证的类型检查器、内置理论和定理证明器。**因此，不同的应用程序使用PVS只是为了为其系统属性提供正式的验证支持。PVS定理证明器基本上是基本推理规则和高级证明策略的集合**。它在序贯演算框架之间进行交互应用。

PVS在检查表格规范时自动生成与完整性和一致性相关的不同定理。在PVS中，定理在不同类型的构造函数的帮助下以一种简单的方式公式化。
PVS通常自动验证。通过这种验证，PVS可以简单地验证与完整性和一致性相关的各种定理。
PVS还借助了经典逻辑和全函数。另一方面，它还提供了谓词和依赖类型，这些类型在约束本来是部分函数的域时很有用。
PVS还在创建类型检查条件(tcc)时对理论进行解析和类型检查。
PVS还生成文档，如PostScript、HTML等形式的理论和证明。

![alt text](image-3.png)

#### 同步飞行员飞行示例
四个主要组件组成，Left_Side FGS Right_Side_FGS、和连接两侧的LR_Bus、RL_Bus。如图所示
![alt text](image-4.png)

假设所有四个组件都由相同的主时钟驱动并同步执行。每个FGS产生一个Pilot_Flying_Side布尔输出，表明它是否认为自己是当前的飞行员飞行方。两个总线将一方产生的值传递给另一方，从而在流程中引入一步延迟。每个FGS接受一个布尔值作为输入，表示Transfer_Switch的当前值。并且Pilot_Flying_Side值从总线的另一边传递过来。每个FGS还接受一个布尔常量，指示是否是Primary_Side将成为初始飞行员飞行侧。将Left_Side的常量设置为true，使其成为初始飞行员飞行侧，而将Right_Side的输入设置为false。中间连接C1、C2、C3和C4也在图上进行了标记，以便于讨论形式规范和证明。

同步Pilot Flying示例中的每个总线都通过一步将其输入转换为输出
延迟。指定此行为的PVS理论如图8所示。
![alt text](image-5.png)
原文内容极其详细。

##### 高阶逻辑(Higher Order Logic 4, HOL4)
在HOL4符号中，“~”为“非”运算符，“/\”为合取，“\/”为析取，“T”为真，“F”为假。“!”符号代表“所有”，而“?”符号是“存在”。最后，' <| '和' |> '是用来表示记录结构的。

![alt text](image-6.png)


### 案例研究2：模型校验
本章演示了使用模型检查来验证FGS单侧模式逻辑的正确性。FGS模式逻辑虽然相当复杂，但仅由布尔输入和输出组成。这使得它非常适合于使用广泛的**模型检查器进行正式验证**，包括基于隐式状态BDD的模型检查器，如NuSMV，以及基于可满足模理论(SMT)的模型检查器，如Kind。虽然仅由布尔逻辑组成的模型非常适合模型检查，但大多数模型检查器也可以处理带有枚举类型和小整数的模型。基于smt的模型检查器(如Kind)如果不涉及非线性算法，也可以处理实数模型。本章的其余部分组织如下。第4.1节提供了FGS模式逻辑的概述。4.2节描述了模式逻辑的软件验证计划，**确定了要产生的生命周期数据项、要满足的DO-178C目标和工具确认问题**。第4.3节提供了作为MATLAB Simulink/Stateflow模型的模式逻辑的详细规范。第4.4节讨论了使用Kind模型检查器和Simulink Design VerifierTM对模式逻辑进行形式化验证

### 案例研究3：抽象解释
本节演示了如何使用抽象解释来验证示例系统的一种飞行控制模式的源代码实现的正确性。航向控制律源代码由控制器的Simulink模型生成的C代码组成。我们将使用Polyspace和Astree抽象解释工具检查与代码运行时行为相关的各种非功能属性。本章的其余部分组织如下。第5.1节概述了Heading Control模型以及由此生成的源代码。它还描述了将由抽象解释检查的属性类型。第5.2节描述了航向控制源代码的软件验证计划，确定了要生成的生命周期数据项、要满足的DO-178C目标和工具资格问题。第5.3节和5.4节分别描述了使用Astree和Polyspace的正式验证结果。